<div
  id="authModal"
  class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center p-4"
>
  <div class="bg-white rounded-2xl max-w-md w-full p-8 relative">

    <button
      onclick="closeAuthModal()"
      class="absolute top-4 right-4"
    >âœ•</button>

    <h2 id="authTitle" class="text-xl font-semibold mb-6">
      Welcome Back
    </h2>

    {% if messages %}
      <div class="mb-4">
        {% for message in messages %}
          <p class="text-red-600 text-sm">{{ message }}</p>
        {% endfor %}
      </div>
    {% endif %}

    <form
      method="POST"
      id="authForm"
      action="{% url 'signin' %}"
      class="space-y-4"
    >
      {% csrf_token %}

      <div>
        <label>Username</label>
        <input name="username" required class="w-full border px-4 py-2 rounded">
      </div>

      <div id="emailField" class="hidden">
        <label>Email</label>
        <input name="email" type="email" class="w-full border px-4 py-2 rounded">
      </div>

      <div>
        <label>Password</label>
        <input name="password" type="password" required class="w-full border px-4 py-2 rounded">
      </div>

      <button
        type="submit"
        class="w-full py-3 bg-orange-600 text-white rounded"
      >
        Sign In
      </button>
    </form>

    <p class="text-center mt-4 text-sm">
      <span id="switchText">Don't have an account?</span>
      <button onclick="switchAuthMode()" class="text-orange-600">
        Sign Up
      </button>
    </p>
  </div>
</div>

<script>
  let authMode = "login";

  function openAuthModal(mode) {
    authMode = mode;
    authModal.classList.remove("hidden");
    authModal.classList.add("flex");
    updateAuthUI();
  }

  function closeAuthModal() {
    authModal.classList.add("hidden");
    authModal.classList.remove("flex");
  }

  function switchAuthMode() {
    authMode = authMode === "login" ? "signup" : "login";
    updateAuthUI();
  }

  function updateAuthUI() {
    const signup = authMode === "signup";

    document.getElementById("authTitle").innerText =
      signup ? "Create Account" : "Welcome Back";

    document.getElementById("emailField")
      .classList.toggle("hidden", !signup);

    document.querySelector("button[type='submit']").innerText =
      signup ? "Create Account" : "Sign In";

    document.getElementById("switchText").innerText =
      signup ? "Already have an account?" : "Don't have an account?";

    document.getElementById("authForm").action =
      signup ? "/signup/" : "/signin/";
  }
</script>
